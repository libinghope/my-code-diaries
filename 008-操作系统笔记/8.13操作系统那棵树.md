---
date: 2020/2/25
comments: true
categories:
  - 操作系统
tags:
  - 操作系统
  - 复杂系统
permalink: '3.13'
title: 操作系统那棵树
---

操作系统是一个复杂系统，可以说是非常的复杂，但是这个复杂系统不是一天完成的。无论多么的复杂的参天大树，  
一开始也只是一颗种子，长成小树苗，一点一点的最终长成现在的样子。
操作系统最开始是用来管理CPU,一开始使用一个栈+yield的方式来实现，
但是这种方式造成了混乱，此时遇到了问题，那就解决问题，于是就引入了另外一个栈，CPU切换顺利完成。  
此时的运行都是在用户态，程序不能永远在用户态执行，也就是需要切换到内核态。这就引入了内核栈，实现内核栈和用户态的切换。  
linux0.01版本，就是在终端交替打印A和B——这就是那棵种子最开始的萌芽。
int main(){
    if(!fork()){while(1) printf("A);}
    if(!fork()){while(1) printf("A");}
}

schedule+switch_to,用来切换进程，切换进程的前提是必须有进程可以切换，copy_process会复制出打印A和打印B的进程，
当主进程让出CPU的时候，就开始这行这两个进程，如何让这两个进程交替运行呢？  
这是就用到了时钟中断，时钟中断counter会不断递减，减到0的时候，无论当前进程(A进程)执行到什么位置，都必须停下，进行调度，开始执行别的进程(B进程)，此时counter复位后继续递减，再次到0，再次切换进程，以此类推......
